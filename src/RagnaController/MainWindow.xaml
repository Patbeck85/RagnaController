<Window x:Class="RagnaController.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="RagnaController"
        Width="980" Height="680"
        MinWidth="880" MinHeight="600"
        Background="{StaticResource BG0Brush}"
        Foreground="{StaticResource TextHiBrush}"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        Closing="Window_Closing"
        MouseLeftButtonDown="Window_MouseLeftButtonDown">

    <Window.Resources>

        <!-- Scanline / grid overlay pattern -->
        <DrawingBrush x:Key="GridOverlay" TileMode="Tile"
                      Viewport="0,0,40,40" ViewportUnits="Absolute"
                      Opacity="0.025">
            <DrawingBrush.Drawing>
                <GeometryDrawing Brush="#00CFFF">
                    <GeometryDrawing.Geometry>
                        <GeometryGroup>
                            <LineGeometry StartPoint="0,0" EndPoint="40,0"/>
                            <LineGeometry StartPoint="0,0" EndPoint="0,40"/>
                        </GeometryGroup>
                    </GeometryDrawing.Geometry>
                </GeometryDrawing>
            </DrawingBrush.Drawing>
        </DrawingBrush>

        <!-- Horizontal separator line with neon gradient -->
        <Style x:Key="NeonSep" TargetType="Border">
            <Setter Property="Height"     Value="1"/>
            <Setter Property="Background" Value="{StaticResource NeonLineGrad}"/>
            <Setter Property="Margin"     Value="0,0,0,0"/>
            <Setter Property="Opacity"    Value="0.4"/>
        </Style>

        <!-- Section label -->
        <Style x:Key="SectionLbl" TargetType="TextBlock">
            <Setter Property="Foreground"       Value="{StaticResource TextLowBrush}"/>
            <Setter Property="FontSize"         Value="9"/>
            <Setter Property="FontWeight"       Value="Bold"/>
            <Setter Property="CharacterSpacing" Value="200"/>
            <Setter Property="Margin"           Value="0,0,0,10"/>
        </Style>

        <!-- Value label -->
        <Style x:Key="ValLbl" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource TextMidBrush}"/>
            <Setter Property="FontSize"   Value="10"/>
            <Setter Property="Margin"     Value="0,0,0,4"/>
        </Style>

        <!-- Card panel -->
        <Style x:Key="Card" TargetType="Border">
            <Setter Property="Background"      Value="{StaticResource CardGrad}"/>
            <Setter Property="BorderBrush"     Value="{StaticResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius"    Value="8"/>
            <Setter Property="Padding"         Value="16"/>
            <Setter Property="Margin"          Value="0,0,0,10"/>
            <Setter Property="Effect"          Value="{StaticResource CardShadow}"/>
        </Style>

        <!-- Glowing stat number -->
        <Style x:Key="StatNum" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource NeonBrush}"/>
            <Setter Property="FontSize"   Value="22"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Effect"     Value="{StaticResource NeonGlow}"/>
        </Style>

    </Window.Resources>

    <!-- Root grid with grid overlay -->
    <Grid>
        <!-- Background grid texture -->
        <Rectangle Fill="{StaticResource GridOverlay}" IsHitTestVisible="False"/>

        <!-- Ambient top glow -->
        <Rectangle VerticalAlignment="Top" Height="200" IsHitTestVisible="False">
            <Rectangle.Fill>
                <RadialGradientBrush GradientOrigin="0.5,0" Center="0.5,0"
                                     RadiusX="0.6" RadiusY="0.5">
                    <GradientStop Color="#08003355" Offset="0"/>
                    <GradientStop Color="Transparent" Offset="1"/>
                </RadialGradientBrush>
            </Rectangle.Fill>
        </Rectangle>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="52"/>   <!-- Title bar -->
                <RowDefinition Height="32"/>   <!-- Menu bar -->
                <RowDefinition Height="Auto"/> <!-- Neon line -->
                <RowDefinition Height="70"/>   <!-- Hero header -->
                <RowDefinition Height="Auto"/> <!-- Neon line -->
                <RowDefinition Height="*"/>    <!-- Content -->
                <RowDefinition Height="34"/>   <!-- Status bar -->
            </Grid.RowDefinitions>

            <!-- ═══════════════════════════════════════════════════
                 TITLE BAR (custom, draggable)
                 ═══════════════════════════════════════════════════ -->
            <Border Grid.Row="0" Background="{StaticResource HeaderGrad}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,0,0,1">
                <Grid Margin="16,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo mark -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <!-- Controller icon SVG-style -->
                        <Viewbox Width="22" Height="22" Margin="0,0,8,0">
                            <Canvas Width="32" Height="32">
                                <!-- Controller body -->
                                <Path Fill="#00CFFF" Opacity="0.9"
                                      Data="M4,10 C4,8 6,6 10,6 L22,6 C26,6 28,8 28,10 L28,22 C28,24 26,26 22,26 L10,26 C6,26 4,24 4,22 Z"/>
                                <!-- Left stick -->
                                <Ellipse Canvas.Left="8" Canvas.Top="13" Width="6" Height="6" Fill="#080A0F"/>
                                <!-- Right stick -->
                                <Ellipse Canvas.Left="18" Canvas.Top="16" Width="6" Height="6" Fill="#080A0F"/>
                                <!-- D-pad vertical -->
                                <Rectangle Canvas.Left="11" Canvas.Top="9" Width="3" Height="9" Fill="#080A0F" RadiusX="1" RadiusY="1"/>
                                <!-- D-pad horizontal -->
                                <Rectangle Canvas.Left="8" Canvas.Top="12" Width="9" Height="3" Fill="#080A0F" RadiusX="1" RadiusY="1"/>
                                <!-- ABXY dots -->
                                <Ellipse Canvas.Left="21" Canvas.Top="9" Width="4" Height="4" Fill="#3DDB6E"/>
                                <Ellipse Canvas.Left="25" Canvas.Top="13" Width="4" Height="4" Fill="#FF3A52"/>
                                <Ellipse Canvas.Left="17" Canvas.Top="13" Width="4" Height="4" Fill="#3A8EFF"/>
                                <Ellipse Canvas.Left="21" Canvas.Top="17" Width="4" Height="4" Fill="#FFB800"/>
                            </Canvas>
                        </Viewbox>
                        <TextBlock Text="RAGNA" FontSize="14" FontWeight="Black"
                                   Foreground="{StaticResource TextHiBrush}" VerticalAlignment="Center"/>
                        <TextBlock Text="CONTROLLER" FontSize="14" FontWeight="Black"
                                   Foreground="{StaticResource NeonBrush}"
                                   Effect="{StaticResource NeonGlow}"
                                   VerticalAlignment="Center" Margin="2,0,0,0"/>
                        <Border Background="{StaticResource BG4Brush}"
                                CornerRadius="3" Padding="5,2" Margin="10,0,0,0"
                                VerticalAlignment="Center">
                            <TextBlock Text="v1.0" FontSize="9" FontWeight="Bold"
                                       Foreground="{StaticResource NeonDimBrush}"/>
                        </Border>
                    </StackPanel>

                    <!-- Controller connection -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal"
                                HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Ellipse x:Name="ControllerDot" Width="7" Height="7"
                                 Fill="{StaticResource StateOffBrush}"
                                 Margin="0,0,7,0"/>
                        <TextBlock x:Name="ControllerStatusText"
                                   Text="NO CONTROLLER"
                                   FontSize="10" FontWeight="Bold"
                                   CharacterSpacing="100"
                                   Foreground="{StaticResource TextMidBrush}"/>
                    </StackPanel>

                    <!-- Window buttons -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="—" Width="36" Height="28"
                                FontSize="14"
                                Style="{StaticResource ConsoleGhostBtn}"
                                Padding="0"
                                Click="BtnMinimize_Click"/>
                        <Button Content="✕" Width="36" Height="28"
                                FontSize="12"
                                Style="{StaticResource ConsoleDangerBtn}"
                                Padding="0" Margin="4,0,0,0"
                                Click="BtnClose_Click"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- ═══════════════════════════════════════════════════
                 MENU BAR
                 ═══════════════════════════════════════════════════ -->
            <Menu Grid.Row="1" Background="{StaticResource BG2Brush}"
                  BorderBrush="{StaticResource BorderBrush}"
                  BorderThickness="0,0,0,1"
                  Foreground="{StaticResource TextHiBrush}">
                
                <!-- File Menu -->
                <MenuItem Header="_File" Height="32">
                    <MenuItem Header="New Profile..." Click="MenuNewProfile_Click"/>
                    <MenuItem Header="Import Profile..." Click="MenuImportProfile_Click"/>
                    <MenuItem Header="Export Profile..." Click="MenuExportProfile_Click"/>
                    <Separator/>
                    <MenuItem Header="Exit" Click="MenuExit_Click"/>
                </MenuItem>
                
                <!-- Edit Menu -->
                <MenuItem Header="_Edit" Height="32">
                    <MenuItem Header="Remap Buttons..." Click="MenuRemapButtons_Click"/>
                    <MenuItem Header="Edit Current Profile..." Click="MenuEditProfile_Click"/>
                    <Separator/>
                    <MenuItem Header="Settings..." Click="MenuSettings_Click"/>
                </MenuItem>
                
                <!-- Tools Menu -->
                <MenuItem Header="_Tools" Height="32">
                    <MenuItem Header="Record Macro..." Click="MenuRecordMacro_Click"/>
                    <MenuItem Header="Edit Macro..." Click="MenuEditMacro_Click"/>
                    <Separator/>
                    <MenuItem Header="Profile Library..." Click="MenuProfileLibrary_Click"/>
                    <MenuItem Header="Macro Browser..." Click="MenuMacroBrowser_Click"/>
                </MenuItem>
                
                <!-- View Menu -->
                <MenuItem Header="_View" Height="32">
                    <MenuItem Header="Mini Mode" Click="MenuMiniMode_Click" InputGestureText="Ctrl+F"/>
                    <Separator/>
                    <MenuItem Header="Export Session Log..." Click="MenuExportLog_Click"/>
                </MenuItem>
                
                <!-- Help Menu -->
                <MenuItem Header="_Help" Height="32">
                    <MenuItem Header="Documentation" Click="MenuDocumentation_Click"/>
                    <MenuItem Header="Keyboard Shortcuts" Click="MenuKeyboardShortcuts_Click"/>
                    <Separator/>
                    <MenuItem Header="Check for Updates..." Click="MenuCheckUpdates_Click"/>
                    <MenuItem Header="About RagnaController" Click="MenuAbout_Click"/>
                </MenuItem>
            </Menu>

            <!-- Neon separator line -->
            <Border Grid.Row="2" Style="{StaticResource NeonSep}"/>

            <!-- ═══════════════════════════════════════════════════
                 HERO HEADER — Profile + Engine controls
                 ═══════════════════════════════════════════════════ -->
            <Grid Grid.Row="3" Margin="20,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="220"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Engine status / START-STOP -->
                <StackPanel Grid.Column="0" Orientation="Horizontal"
                            VerticalAlignment="Center">
                    <Button x:Name="BtnStart"
                            Content="▶  START ENGINE"
                            Style="{StaticResource ConsoleFilledBtn}"
                            FontSize="12" Padding="22,11"
                            Click="BtnStart_Click"/>
                    <Button x:Name="BtnStop"
                            Content="■  STOP"
                            Style="{StaticResource ConsoleDangerBtn}"
                            FontSize="12" Padding="22,11"
                            Margin="10,0,0,0"
                            IsEnabled="False"
                            Click="BtnStop_Click"/>
                </StackPanel>

                <!-- Profile selector -->
                <StackPanel Grid.Column="2" VerticalAlignment="Center">
                    <TextBlock Text="ACTIVE PROFILE" Style="{StaticResource SectionLbl}" Margin="0,0,0,5"/>
                    <ComboBox x:Name="ProfileCombo"
                              Style="{StaticResource ConsoleCombo}"
                              SelectionChanged="ProfileCombo_SelectionChanged"
                              FontSize="13"/>
                </StackPanel>

                <!-- Live stats -->
                <StackPanel Grid.Column="3" Orientation="Horizontal"
                            HorizontalAlignment="Center" VerticalAlignment="Center"
                            Margin="20,0">
                    <!-- Sensitivity stat -->
                    <StackPanel Margin="0,0,28,0" HorizontalAlignment="Center">
                        <TextBlock Text="SENSITIVITY" Style="{StaticResource SectionLbl}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock x:Name="StatSens" Text="1.2"
                                   Style="{StaticResource StatNum}"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                    <!-- Deadzone stat -->
                    <StackPanel Margin="0,0,28,0" HorizontalAlignment="Center">
                        <TextBlock Text="DEADZONE" Style="{StaticResource SectionLbl}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock x:Name="StatDead" Text="0.12"
                                   Style="{StaticResource StatNum}"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                    <!-- Layer stat -->
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="LAYER" Style="{StaticResource SectionLbl}"
                                   HorizontalAlignment="Center"/>
                        <TextBlock x:Name="StatLayer" Text="BASE"
                                   Style="{StaticResource StatNum}"
                                   HorizontalAlignment="Center"/>
                    </StackPanel>
                </StackPanel>

                <!-- Engine pulse indicator -->
                <StackPanel Grid.Column="4" VerticalAlignment="Center" HorizontalAlignment="Right">
                    <TextBlock Text="ENGINE" Style="{StaticResource SectionLbl}" HorizontalAlignment="Center"/>
                    <Ellipse x:Name="EnginePulse" Width="26" Height="26"
                             HorizontalAlignment="Center"
                             Fill="{StaticResource StateOffBrush}"
                             Effect="{StaticResource RedGlow}"/>
                </StackPanel>
            </Grid>

            <!-- Neon separator -->
            <Border Grid.Row="4" Style="{StaticResource NeonSep}"/>

            <!-- ═══════════════════════════════════════════════════
                 MAIN CONTENT
                 ═══════════════════════════════════════════════════ -->
            <Grid Grid.Row="5" Margin="16,12,16,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="230"/>
                    <ColumnDefinition Width="14"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- ── LEFT SIDEBAR ──────────────────────────────── -->
                <StackPanel Grid.Column="0">

                    <!-- Controller Visualizer -->
                    <Border Style="{StaticResource Card}" Padding="14">
                        <StackPanel>
                            <TextBlock Text="CONTROLLER INPUT" Style="{StaticResource SectionLbl}"/>

                            <!-- Gamepad visual -->
                            <Grid Width="190" Height="100" HorizontalAlignment="Center" Margin="0,4,0,10">
                                <!-- Gamepad body -->
                                <Border CornerRadius="50,50,40,40" Background="{StaticResource BG3Brush}"
                                        BorderBrush="{StaticResource BorderBrush}" BorderThickness="1"
                                        Margin="20,10,20,0"/>

                                <!-- Left stick zone -->
                                <Border Width="52" Height="52" CornerRadius="26"
                                        Background="{StaticResource BG0Brush}"
                                        BorderBrush="{StaticResource BG4Brush}" BorderThickness="1"
                                        HorizontalAlignment="Left" VerticalAlignment="Bottom"
                                        Margin="32,0,0,10">
                                    <Canvas x:Name="LeftStickCanvas" Width="52" Height="52">
                                        <Ellipse x:Name="LeftStickDot"
                                                 Width="14" Height="14"
                                                 Canvas.Left="19" Canvas.Top="19">
                                            <Ellipse.Fill>
                                                <SolidColorBrush Color="#00CFFF"/>
                                            </Ellipse.Fill>
                                            <Ellipse.Effect>
                                                <DropShadowEffect Color="#00CFFF" BlurRadius="10" ShadowDepth="0" Opacity="0.8"/>
                                            </Ellipse.Effect>
                                        </Ellipse>
                                    </Canvas>
                                </Border>

                                <!-- Right stick zone -->
                                <Border Width="42" Height="42" CornerRadius="21"
                                        Background="{StaticResource BG0Brush}"
                                        BorderBrush="{StaticResource BG4Brush}" BorderThickness="1"
                                        HorizontalAlignment="Right" VerticalAlignment="Bottom"
                                        Margin="0,0,36,14">
                                    <Canvas x:Name="RightStickCanvas" Width="42" Height="42">
                                        <Ellipse x:Name="RightStickDot"
                                                 Width="10" Height="10"
                                                 Canvas.Left="16" Canvas.Top="16">
                                            <Ellipse.Fill>
                                                <SolidColorBrush Color="#FFB800"/>
                                            </Ellipse.Fill>
                                            <Ellipse.Effect>
                                                <DropShadowEffect Color="#FFB800" BlurRadius="8" ShadowDepth="0" Opacity="0.8"/>
                                            </Ellipse.Effect>
                                        </Ellipse>
                                    </Canvas>
                                </Border>

                                <!-- ABXY mini indicators -->
                                <StackPanel HorizontalAlignment="Right" VerticalAlignment="Top"
                                            Margin="0,18,26,0">
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Ellipse x:Name="DotY" Width="9" Height="9" Fill="{StaticResource BtnYBrush}" Margin="2"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse x:Name="DotX" Width="9" Height="9" Fill="{StaticResource BtnXBrush}" Margin="2"/>
                                        <Ellipse x:Name="DotB" Width="9" Height="9" Fill="{StaticResource BtnBBrush}" Margin="2"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Ellipse x:Name="DotA" Width="9" Height="9" Fill="{StaticResource BtnABrush}" Margin="2"/>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>

                            <!-- Layer badge -->
                            <Border x:Name="LayerBadge"
                                    HorizontalAlignment="Stretch"
                                    CornerRadius="4" Padding="0,6"
                                    Margin="0,0,0,6">
                                <Border.Background>
                                    <SolidColorBrush x:Name="LayerBadgeBG" Color="#0A1A28"/>
                                </Border.Background>
                                <TextBlock x:Name="LayerText"
                                           Text="● BASE LAYER"
                                           FontSize="11" FontWeight="Bold"
                                           CharacterSpacing="80"
                                           HorizontalAlignment="Center">
                                    <TextBlock.Foreground>
                                        <SolidColorBrush x:Name="LayerTextColor" Color="#00CFFF"/>
                                    </TextBlock.Foreground>
                                </TextBlock>
                            </Border>

                            <!-- Combat State HUD -->
                            <Border x:Name="CombatHUD"
                                    CornerRadius="6"
                                    Padding="10,8"
                                    HorizontalAlignment="Stretch">
                                <Border.Background>
                                    <SolidColorBrush x:Name="CombatHUDBG" Color="#0A0E16"/>
                                </Border.Background>
                                <Border.BorderBrush>
                                    <SolidColorBrush x:Name="CombatHUDBorder" Color="#1E2840"/>
                                </Border.BorderBrush>
                                <Border.BorderThickness>
                                    <Thickness>1</Thickness>
                                </Border.BorderThickness>
                                <StackPanel>
                                    <TextBlock Text="COMBAT STATE" FontSize="9" FontWeight="Bold"
                                               CharacterSpacing="150"
                                               Foreground="{StaticResource TextLowBrush}"
                                               HorizontalAlignment="Center"
                                               Margin="0,0,0,4"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Ellipse x:Name="CombatDot" Width="7" Height="7"
                                                 VerticalAlignment="Center" Margin="0,0,6,0">
                                            <Ellipse.Fill>
                                                <SolidColorBrush x:Name="CombatDotColor" Color="#3D4A6E"/>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                        <TextBlock x:Name="CombatStateText"
                                                   Text="IDLE"
                                                   FontSize="12" FontWeight="Bold"
                                                   CharacterSpacing="80">
                                            <TextBlock.Foreground>
                                                <SolidColorBrush x:Name="CombatStateColor" Color="#3D4A6E"/>
                                            </TextBlock.Foreground>
                                        </TextBlock>
                                    </StackPanel>
                                    <TextBlock x:Name="CombatHint"
                                               Text="Press L3 to enter combat mode"
                                               FontSize="9"
                                               Foreground="{StaticResource TextLowBrush}"
                                               HorizontalAlignment="Center"
                                               Margin="0,4,0,0"
                                               TextWrapping="Wrap"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Settings -->
                    <Border Style="{StaticResource Card}" Padding="14">
                        <StackPanel>
                            <TextBlock Text="INPUT SETTINGS" Style="{StaticResource SectionLbl}"/>

                            <!-- Sensitivity -->
                            <TextBlock Text="SENSITIVITY" Style="{StaticResource ValLbl}"/>
                            <Grid Margin="0,0,0,14">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="36"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="SensitivitySlider" Minimum="0.2" Maximum="3.0"
                                        VerticalAlignment="Center"
                                        ValueChanged="SensitivitySlider_ValueChanged">
                                    <Slider.Template>
                                        <ControlTemplate TargetType="Slider">
                                            <Grid VerticalAlignment="Center" Height="20">
                                                <Border Height="2" CornerRadius="1"
                                                        Background="{StaticResource BG4Brush}"
                                                        VerticalAlignment="Center"/>
                                                <Track x:Name="PART_Track">
                                                    <Track.DecreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="{StaticResource NeonBrush}"
                                                                            CornerRadius="1" VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.DecreaseRepeatButton>
                                                    <Track.Thumb>
                                                        <Thumb>
                                                            <Thumb.Template>
                                                                <ControlTemplate>
                                                                    <Ellipse Width="13" Height="13" Fill="{StaticResource NeonBrush}">
                                                                        <Ellipse.Effect>
                                                                            <DropShadowEffect Color="#00CFFF" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                                                        </Ellipse.Effect>
                                                                    </Ellipse>
                                                                </ControlTemplate>
                                                            </Thumb.Template>
                                                        </Thumb>
                                                    </Track.Thumb>
                                                    <Track.IncreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="Transparent"
                                                                            CornerRadius="1" VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.IncreaseRepeatButton>
                                                </Track>
                                            </Grid>
                                        </ControlTemplate>
                                    </Slider.Template>
                                </Slider>
                                <TextBlock x:Name="SensitivityValue" Grid.Column="1"
                                           Text="1.2" FontSize="13" FontWeight="Bold"
                                           Foreground="{StaticResource NeonBrush}"
                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Deadzone -->
                            <TextBlock Text="DEADZONE" Style="{StaticResource ValLbl}"/>
                            <Grid Margin="0,0,0,14">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="36"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="DeadzoneSlider" Minimum="0.02" Maximum="0.40"
                                        VerticalAlignment="Center"
                                        ValueChanged="DeadzoneSlider_ValueChanged">
                                    <Slider.Template>
                                        <ControlTemplate TargetType="Slider">
                                            <Grid VerticalAlignment="Center" Height="20">
                                                <Border Height="2" CornerRadius="1"
                                                        Background="{StaticResource BG4Brush}"
                                                        VerticalAlignment="Center"/>
                                                <Track x:Name="PART_Track">
                                                    <Track.DecreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="{StaticResource BtnYBrush}"
                                                                            CornerRadius="1" VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.DecreaseRepeatButton>
                                                    <Track.Thumb>
                                                        <Thumb>
                                                            <Thumb.Template>
                                                                <ControlTemplate>
                                                                    <Ellipse Width="13" Height="13" Fill="{StaticResource BtnYBrush}">
                                                                        <Ellipse.Effect>
                                                                            <DropShadowEffect Color="#FFB800" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                                                        </Ellipse.Effect>
                                                                    </Ellipse>
                                                                </ControlTemplate>
                                                            </Thumb.Template>
                                                        </Thumb>
                                                    </Track.Thumb>
                                                    <Track.IncreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="Transparent"
                                                                            VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.IncreaseRepeatButton>
                                                </Track>
                                            </Grid>
                                        </ControlTemplate>
                                    </Slider.Template>
                                </Slider>
                                <TextBlock x:Name="DeadzoneValue" Grid.Column="1"
                                           Text="0.12" FontSize="13" FontWeight="Bold"
                                           Foreground="{StaticResource BtnYBrush}"
                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            </Grid>

                            <!-- Action RPG Mode Toggle -->
                            <TextBlock Text="MOVEMENT MODE" Style="{StaticResource ValLbl}"/>
                            <Border CornerRadius="5" Margin="0,0,0,14"
                                    Padding="10,0">
                                <Border.Background>
                                    <SolidColorBrush Color="#111828"/>
                                </Border.Background>
                                <Grid Height="38">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock x:Name="MoveModeLabel"
                                                   Text="Action RPG"
                                                   FontSize="12" FontWeight="Bold"
                                                   Foreground="{StaticResource NeonBrush}"/>
                                        <TextBlock x:Name="MoveModeDesc"
                                                   Text="LS holds LMB + drifts cursor"
                                                   FontSize="9"
                                                   Foreground="{StaticResource TextLowBrush}"/>
                                    </StackPanel>
                                    <!-- Toggle switch -->
                                    <Border x:Name="ToggleBg" Grid.Column="1"
                                            Width="42" Height="22" CornerRadius="11"
                                            Background="{StaticResource NeonBrush}"
                                            Cursor="Hand"
                                            MouseLeftButtonDown="MoveModeToggle_Click">
                                        <Border.Effect>
                                            <DropShadowEffect Color="#00CFFF" BlurRadius="8" ShadowDepth="0" Opacity="0.8"/>
                                        </Border.Effect>
                                        <Ellipse x:Name="ToggleThumb"
                                                 Width="16" Height="16"
                                                 Fill="White"
                                                 HorizontalAlignment="Right"
                                                 Margin="0,0,3,0"/>
                                    </Border>
                                </Grid>
                            </Border>

                            <!-- Action Speed (visible in ARPG mode only) -->
                            <TextBlock x:Name="LblActionSpeed" Text="RUN SPEED" Style="{StaticResource ValLbl}"/>
                            <Grid x:Name="ActionSpeedRow" Margin="0,0,0,14">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="36"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="ActionSpeedSlider" Minimum="1.0" Maximum="12.0"
                                        VerticalAlignment="Center"
                                        ValueChanged="ActionSpeedSlider_ValueChanged">
                                    <Slider.Template>
                                        <ControlTemplate TargetType="Slider">
                                            <Grid VerticalAlignment="Center" Height="20">
                                                <Border Height="2" CornerRadius="1"
                                                        Background="{StaticResource BG4Brush}"
                                                        VerticalAlignment="Center"/>
                                                <Track x:Name="PART_Track">
                                                    <Track.DecreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="{StaticResource BtnABrush}"
                                                                            CornerRadius="1" VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.DecreaseRepeatButton>
                                                    <Track.Thumb>
                                                        <Thumb>
                                                            <Thumb.Template>
                                                                <ControlTemplate>
                                                                    <Ellipse Width="13" Height="13" Fill="{StaticResource BtnABrush}">
                                                                        <Ellipse.Effect>
                                                                            <DropShadowEffect Color="#3DDB6E" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                                                        </Ellipse.Effect>
                                                                    </Ellipse>
                                                                </ControlTemplate>
                                                            </Thumb.Template>
                                                        </Thumb>
                                                    </Track.Thumb>
                                                    <Track.IncreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="Transparent"
                                                                            VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.IncreaseRepeatButton>
                                                </Track>
                                            </Grid>
                                        </ControlTemplate>
                                    </Slider.Template>
                                </Slider>
                                <TextBlock x:Name="ActionSpeedValue" Grid.Column="1"
                                           Text="5.0" FontSize="13" FontWeight="Bold"
                                           Foreground="{StaticResource BtnABrush}"
                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            </Grid>

                        <!-- Curve -->
                            <TextBlock Text="RESPONSE CURVE" Style="{StaticResource ValLbl}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="36"/>
                                </Grid.ColumnDefinitions>
                                <Slider x:Name="CurveSlider" Minimum="1.0" Maximum="3.0"
                                        VerticalAlignment="Center"
                                        ValueChanged="CurveSlider_ValueChanged">
                                    <Slider.Template>
                                        <ControlTemplate TargetType="Slider">
                                            <Grid VerticalAlignment="Center" Height="20">
                                                <Border Height="2" CornerRadius="1"
                                                        Background="{StaticResource BG4Brush}"
                                                        VerticalAlignment="Center"/>
                                                <Track x:Name="PART_Track">
                                                    <Track.DecreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="{StaticResource BtnLRBrush}"
                                                                            CornerRadius="1" VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.DecreaseRepeatButton>
                                                    <Track.Thumb>
                                                        <Thumb>
                                                            <Thumb.Template>
                                                                <ControlTemplate>
                                                                    <Ellipse Width="13" Height="13" Fill="{StaticResource BtnLRBrush}">
                                                                        <Ellipse.Effect>
                                                                            <DropShadowEffect Color="#9F7AFF" BlurRadius="8" ShadowDepth="0" Opacity="0.9"/>
                                                                        </Ellipse.Effect>
                                                                    </Ellipse>
                                                                </ControlTemplate>
                                                            </Thumb.Template>
                                                        </Thumb>
                                                    </Track.Thumb>
                                                    <Track.IncreaseRepeatButton>
                                                        <RepeatButton>
                                                            <RepeatButton.Template>
                                                                <ControlTemplate>
                                                                    <Border Height="2" Background="Transparent"
                                                                            VerticalAlignment="Center"/>
                                                                </ControlTemplate>
                                                            </RepeatButton.Template>
                                                        </RepeatButton>
                                                    </Track.IncreaseRepeatButton>
                                                </Track>
                                            </Grid>
                                        </ControlTemplate>
                                    </Slider.Template>
                                </Slider>
                                <TextBlock x:Name="CurveValue" Grid.Column="1"
                                           Text="1.5" FontSize="13" FontWeight="Bold"
                                           Foreground="{StaticResource BtnLRBrush}"
                                           HorizontalAlignment="Right" VerticalAlignment="Center"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Profile management -->
                    <Border Style="{StaticResource Card}" Padding="14">
                        <StackPanel>
                            <TextBlock Text="PROFILE MANAGEMENT" Style="{StaticResource SectionLbl}"/>
                            <Grid Margin="0,0,0,6">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="6"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Button Content="+ NEW"       Style="{StaticResource ConsolePrimaryBtn}" Click="BtnNewProfile_Click" Padding="0,8"/>
                                <Button Content="DELETE" Grid.Column="2" Style="{StaticResource ConsoleDangerBtn}" Click="BtnDeleteProfile_Click" Padding="0,8"/>
                            </Grid>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition/>
                                    <ColumnDefinition Width="6"/>
                                    <ColumnDefinition/>
                                </Grid.ColumnDefinitions>
                                <Button Content="EXPORT"      Style="{StaticResource ConsoleGhostBtn}" Click="BtnExport_Click" Padding="0,8"/>
                                <Button Content="IMPORT" Grid.Column="2" Style="{StaticResource ConsoleGhostBtn}" Click="BtnImport_Click" Padding="0,8"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                </StackPanel>

                <!-- ── RIGHT PANEL ───────────────────────────────── -->
                <Grid Grid.Column="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Tab navigation — console style -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1"
                                HorizontalAlignment="Stretch">
                            <StackPanel Orientation="Horizontal">

                                <Button x:Name="TabBtnBase"
                                        Content="⊕  BASE LAYER"
                                        Style="{StaticResource ConsolePrimaryBtn}"
                                        Padding="16,9"
                                        Click="TabBase_Click"
                                        Margin="0,0,4,0"/>

                                <Button x:Name="TabBtnL2"
                                        Content="⊕  L2 LAYER"
                                        Style="{StaticResource ConsoleGhostBtn}"
                                        Padding="16,9"
                                        Click="TabL2_Click"
                                        Margin="0,0,4,0"/>

                                <Button x:Name="TabBtnR2"
                                        Content="⊕  R2 LAYER"
                                        Style="{StaticResource ConsoleGhostBtn}"
                                        Padding="16,9"
                                        Click="TabR2_Click"
                                        Margin="0,0,4,0"/>

                                <Button x:Name="TabBtnLog"
                                        Content="◈  EVENT LOG"
                                        Style="{StaticResource ConsoleGhostBtn}"
                                        Padding="16,9"
                                        Click="TabLog_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Mapping panels -->
                    <ScrollViewer x:Name="PanelBase" Grid.Row="6"
                                  VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="MappingsBase" Margin="0,0,6,0"/>
                    </ScrollViewer>

                    <ScrollViewer x:Name="PanelL2" Grid.Row="6"
                                  VerticalScrollBarVisibility="Auto"
                                  Visibility="Collapsed">
                        <StackPanel x:Name="MappingsL2" Margin="0,0,6,0"/>
                    </ScrollViewer>

                    <ScrollViewer x:Name="PanelR2" Grid.Row="6"
                                  VerticalScrollBarVisibility="Auto"
                                  Visibility="Collapsed">
                        <StackPanel x:Name="MappingsR2" Margin="0,0,6,0"/>
                    </ScrollViewer>

                    <!-- Log panel -->
                    <Border x:Name="PanelLog" Grid.Row="6"
                            Style="{StaticResource Card}"
                            Visibility="Collapsed">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBlock x:Name="LogTextBlock"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           Foreground="{StaticResource TextMidBrush}"
                                           TextWrapping="Wrap"/>
                            </ScrollViewer>
                            <Button Grid.Row="6" Content="CLEAR LOG"
                                    Style="{StaticResource ConsoleGhostBtn}"
                                    HorizontalAlignment="Right"
                                    Margin="0,8,0,0"
                                    Click="BtnClearLog_Click"/>
                        </Grid>
                    </Border>
                </Grid>
            </Grid>

            <!-- ═══════════════════════════════════════════════════
                 STATUS BAR
                 ═══════════════════════════════════════════════════ -->
            <Border Grid.Row="6"
                    Background="{StaticResource HeaderGrad}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="0,1,0,0">
                <Grid Margin="16,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Engine status -->
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Ellipse x:Name="StatusDot" Width="6" Height="6"
                                 Fill="{StaticResource StateOffBrush}"
                                 Margin="0,0,7,0"/>
                        <TextBlock x:Name="StatusText"
                                   Text="ENGINE STOPPED"
                                   FontSize="10" FontWeight="Bold"
                                   CharacterSpacing="80"
                                   Foreground="{StaticResource TextMidBrush}"/>
                    </StackPanel>

                    <!-- Safety disclaimer -->
                    <TextBlock Grid.Column="2"
                               Text="SendInput only  ·  No memory access  ·  No injection  ·  Safe"
                               FontSize="9"
                               Foreground="{StaticResource TextLowBrush}"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>

        </Grid>
    </Grid>
</Window>
